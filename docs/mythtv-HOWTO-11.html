<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="LinuxDoc-Tools 0.9.21">
 <TITLE>Installing and using MythTV: Using MythTV.</TITLE>
 <LINK HREF="mythtv-HOWTO-12.html" REL=next>
 <LINK HREF="mythtv-HOWTO-10.html" REL=previous>
 <LINK HREF="mythtv-HOWTO.html#toc11" REL=contents>
</HEAD>
<BODY>
<A HREF="mythtv-HOWTO-12.html">Next</A>
<A HREF="mythtv-HOWTO-10.html">Previous</A>
<A HREF="mythtv-HOWTO.html#toc11">Contents</A>
<HR>
<H2><A NAME="s11">11.</A> <A HREF="mythtv-HOWTO.html#toc11">Using MythTV.</A></H2>

<P>
<FIGURE>
<EPS FILE="stop.eps">
<IMG SRC="stop.png">
<CAPTION><B>NOTE to Red Hat/Fedora 4 users</B>: Red Hat Linux and Fedora Core ship
with Gnome as the default desktop environment.  However, Gnome seems to have
issues with window focus and window switching which sometimes cause
mythfrontend to obscure the video. KDE does not seem to have any such
issues. Therefore you will need to switch to KDE by selecting
RedHatMenu>Extras>System Settings>Desktop Switching Tool and choose "KDE".
<B>NOTE to Fedora Core 5 and 6 users</B>:  Fedora 5 and 6 no longer have
this tool in the Menu. Use "switchdesk KDE" from a command line. Read "man
switchdesk" for further information about changing to other desktop
environments.</CAPTION>
</FIGURE>
</P>
<H2><A NAME="ss11.1">11.1</A> <A HREF="mythtv-HOWTO.html#toc11.1">Keyboard commands</A>
</H2>

<P>The <CODE>keys.txt</CODE> file describes what the various keyboard commands are.
If you have loaded mythweb, you may change the default keys to your liking.</P>
<H3>mythfrontend</H3>

<P>
<BR><CENTER>
<TABLE BORDER><TR><TD>
Arrow keys </TD><TD> used to move the highlight point around </TD></TR><TR><TD>
ALT-F4 </TD><TD> exit out of the application </TD></TR><TR><TD>
Space/Enter     </TD><TD> take action on the item under the highlight point </TD></TR><TR><TD>
P </TD><TD> play in both "Watch a Recording" and "Delete a Recording"   </TD></TR><TR><TD>
D </TD><TD> delete in both "Watch a Recording" and "Delete a Recording" </TD></TR><TR><TD>
U </TD><TD> to view details for the currently selected show on the Watch&nbsp;or Delete screens, EPG, "Program Finder", "Fix Scheduling&nbsp;Conflicts" and search results screens </TD></TR><TR><TD>
O </TD><TD> to list the upcoming episodes for the currently selected show&nbsp;on the EPG, "Program Finder", "Program Recording Priorities",&nbsp;"Fix Scheduling Conflicts" or search results screens </TD></TR><TR><TD>
I </TD><TD> edit recording options from the EPG, "Program Finder",&nbsp;"Program Recording Priorities", or "Fix Scheduling Conflicts"&nbsp;screens. From the Playback and Delete screens, 'I' presents&nbsp;options for recorded shows such as Auto Expire or Stop Recording.&nbsp;Pressing 'I' while on the Recording Options screen will take you&nbsp;to the Advanced Recording Options screen.
</TD></TR></TABLE>
</CENTER><BR>
</P>
<H3>Watching TV or a recording</H3>

<P>
<BR><CENTER>
<TABLE BORDER><TR><TD>
Up or down      </TD><TD> keys change the channel </TD></TR><TR><TD>
num pad </TD><TD> Type a number to enter a channel number or jump amount (HHMM format) </TD></TR><TR><TD>
P </TD><TD> pause / play. You may also add an explicit keybinding for 'Play' through&nbsp;MythWeb, returning you to normal speed if you are in slow motion, rewind&nbsp;fast forward or pause mode. </TD></TR><TR><TD>
C </TD><TD> change inputs on TV Tuner card </TD></TR><TR><TD>
ESC </TD><TD> quits </TD></TR><TR><TD>
I </TD><TD> puts the On-screen Display up again. During playback, 'I' toggles&nbsp;between position and show description info. If a jump amount is&nbsp;entered, jump to that position. </TD></TR><TR><TD>
M </TD><TD> brings up the electronic program guide (Grid) -- see the EPG section </TD></TR><TR><TD>
Page Up </TD><TD> jump back the configured number of minutes (default is 10) </TD></TR><TR><TD>
Page Down       </TD><TD> jump ahead the configured number of minutes (default is 10) </TD></TR><TR><TD>
End or Z        </TD><TD> skip to next commercial break marker </TD></TR><TR><TD>
Home or Q       </TD><TD> skip back to previous commercial break marker </TD></TR><TR><TD>
T </TD><TD> toggle close caption support&nbsp;Pressing 0-9 (preferably 3 times) + T changes teletext page and turns on teletext. </TD></TR><TR><TD>
F </TD><TD> rotate between the various Picture Adjustments (Colour, Hue, etc.)&nbsp;While Picture Adjustment is on-screen, use Left and Right arrows to&nbsp;adjust. These settings adjust the look of the video playback, and are&nbsp;independent of the G-key settings used at record-time. </TD></TR><TR><TD>
[ or F10        </TD><TD> decrease volume </TD></TR><TR><TD>
] or F11        </TD><TD> increase volume </TD></TR><TR><TD>
| or F9 </TD><TD> toggle mute </TD></TR><TR><TD>
/ </TD><TD> jump to the next "favorite" channel </TD></TR><TR><TD>
? </TD><TD> mark/unmark the current channel as a "favorite" </TD></TR><TR><TD>
U </TD><TD> increase the play speed </TD></TR><TR><TD>
J </TD><TD> decrease the play speed </TD></TR><TR><TD>
A </TD><TD> Adjust time stretch (speed up or slow down normal play of audio and video </TD></TR><TR><TD>
W </TD><TD> cycle through zoom and fill modes: 4:3 aspect ratio, 16:9, 4:3 Zoom &nbsp;(like Pan and Scan), 16:9 Zoom, and 16:9 Stretch (eliminates black &nbsp;sidebars in TV signal) </TD></TR><TR><TD>
F8 </TD><TD> toggle the sleep timer 30m->1hr->1hr30m->2hr->Off </TD></TR><TR><TD>
CTRL-B </TD><TD> Jump to the beginning of the recording / ringbuffer </TD></TR><TR><TD>
+ </TD><TD> Switch between audio streams </TD></TR><TR><TD>
Left </TD><TD> (if a jump amount is entered) to jump back that amount </TD></TR><TR><TD>
Right </TD><TD> (if a jump amount is entered) to jump ahead that amount </TD></TR><TR><TD>
</TD><TD> </TD></TR><TR><TD>
</TD><TD> </TD></TR><TR><TD>
</TD><TD> <B>Without the stickykeys option selected</B> </TD></TR><TR><TD>
Left </TD><TD> rewind the configured number of seconds (default is 5) </TD></TR><TR><TD>
Right </TD><TD> fast forward the configured number of seconds (default is 30) </TD></TR><TR><TD>
&lt; </TD><TD> starts rewind mode as if stickykeys are selected </TD></TR><TR><TD>
> </TD><TD> starts fast forward mode as if stickykeys are selected </TD></TR><TR><TD>
</TD><TD> </TD></TR><TR><TD>
</TD><TD> </TD></TR><TR><TD>
</TD><TD> <B>With Stickykeys option selected</B> </TD></TR><TR><TD>
Right </TD><TD> starts fast forward mode </TD></TR><TR><TD>
Left </TD><TD> starts rewind mode </TD></TR><TR><TD>
</TD><TD> </TD></TR><TR><TD>
</TD><TD> </TD></TR><TR><TD>
</TD><TD> <B>In fast forward or rewind mode:</B> </TD></TR><TR><TD>
Left/Right      </TD><TD> increases the ff/rew speed </TD></TR><TR><TD>
0 </TD><TD> plays at normal speed, but leaves the time indicator on screen </TD></TR><TR><TD>
1 or 2 </TD><TD> plays back more slowly than normal ff/rew speed (1 is slowest) </TD></TR><TR><TD>
3 </TD><TD> plays back at normal ff/rew speed </TD></TR><TR><TD>
4-9 </TD><TD> plays back faster than normal ff/rew speed (9 is fastest) </TD></TR><TR><TD>
Space </TD><TD> exits fast forward or rewind mode </TD></TR><TR><TD>
</TD><TD> </TD></TR><TR><TD>
</TD><TD> </TD></TR><TR><TD>
</TD><TD> <B>While video is paused:</B> </TD></TR><TR><TD>
Left </TD><TD> rewind 1 frame </TD></TR><TR><TD>
&lt; </TD><TD> rewind 1 second </TD></TR><TR><TD>
Right </TD><TD> advance 1 frame </TD></TR><TR><TD>
&gt; </TD><TD> advance 1 second
</TD></TR></TABLE>
</CENTER><BR>
</P>
<H3>Watching TV only</H3>

<P>
<BR><CENTER>
<TABLE BORDER><TR><TD>
G       </TD><TD> rotate between the various Picture Adjustments (Colour, Hue, etc.)&nbsp;for recording. These values affect the look of the resulting .nuv&nbsp;file, and are independent of the playback picture settings. While&nbsp;Picture Adjustment is on-screen, use Left and Right arrows to adjust. </TD></TR><TR><TD>
H       </TD><TD> Channel history. Each repeat steps back through the previous channels. </TD></TR><TR><TD>
O       </TD><TD> Turns on 'Browse' mode, allowing user to browse channels and program&nbsp;info while watching current show FullScreen. </TD></TR><TR><TD>
Y       </TD><TD> switch between multiple capture cards.&nbsp; <B>NOTE</B>:&nbsp;you will lose your LiveTV buffer on your current card. Useful&nbsp;for different-sourced cards (such as Dish Network on one, HDTV over-the-air on another card.) </TD></TR><TR><TD>
</TD></TR></TABLE>
</CENTER><BR>
</P>
<H3>LiveTV Browse Mode</H3>

<P>
<BR><CENTER>
<TABLE BORDER><TR><TD>
Left </TD><TD> browse program prior to current listed program </TD></TR><TR><TD>
Right </TD><TD> browse program following current listed program </TD></TR><TR><TD>
Up </TD><TD> browse program on channel above current listed channel/program </TD></TR><TR><TD>
Down </TD><TD> browse program on channel below current listed channel/program </TD></TR><TR><TD>
/ </TD><TD> browse program on next favorite channel </TD></TR><TR><TD>
0-9 </TD><TD> enter a channel number to browse </TD></TR><TR><TD>
Space/Enter     </TD><TD> change channel to channel of current listed program </TD></TR><TR><TD>
R/r </TD><TD> Toggle recording of current program (cycles through types) </TD></TR><TR><TD>
ESC/O </TD><TD> Exit Browse mode
</TD></TR></TABLE>
</CENTER><BR>
</P>
<H3>Playback Recording Zoom Mode</H3>

<P>
<BR><CENTER>
<TABLE BORDER><TR><TD>
Left </TD><TD> Move video to Left </TD></TR><TR><TD>
Right </TD><TD> Move video to Right </TD></TR><TR><TD>
Up </TD><TD> Move video Up </TD></TR><TR><TD>
Down </TD><TD> Move video Down </TD></TR><TR><TD>
PageUp </TD><TD> Zoom In </TD></TR><TR><TD>
PageDown        </TD><TD> Zoom Out </TD></TR><TR><TD>
Space/Enter     </TD><TD> Exit Zoom mode leaving picture at current size and position </TD></TR><TR><TD>
ESC </TD><TD> Exit Zoom mode and return to original size
</TD></TR></TABLE>
</CENTER><BR>
</P>
<H3>If you have two or more tuner cards</H3>

<P>
<BR><CENTER>
<TABLE BORDER><TR><TD>
V       </TD><TD> toggle Picture-in-picture on or off </TD></TR><TR><TD>
B       </TD><TD> toggles the window focus (lets you change channels on the PiP window) </TD></TR><TR><TD>
N       </TD><TD> swaps the two channels by changing channels on both cards
</TD></TR></TABLE>
</CENTER><BR>
</P>
<H3>Watching a recording only</H3>

<P>
<BR><CENTER>
<TABLE BORDER><TR><TD>
Space/Enter </TD><TD> set a bookmark at that point. Next time you start the&nbsp;recording, you will automatically jump forward to this point&nbsp;and clear the bookmark. </TD></TR><TR><TD>
X </TD><TD> queues the current recording for transcoding </TD></TR><TR><TD>
O </TD><TD> brings up menu to allow toggling settings such as Commercial&nbsp;Auto-Skip, Auto-Expire, etc. </TD></TR><TR><TD>
D </TD><TD> exits the current recording and displays the Delete menu </TD></TR><TR><TD>
E or M </TD><TD> enters/exits edit mode. </TD></TR><TR><TD>
</TD><TD> </TD></TR><TR><TD>
</TD><TD> </TD></TR><TR><TD>
</TD><TD> <B>In edit mode</B> </TD></TR><TR><TD>
Left/Right      </TD><TD> move forward and backward </TD></TR><TR><TD>
Up/Down </TD><TD> alter the amount of time you jump forward and backward.&nbsp;Increments are: nearest cutpoint, nearest video keyframe, 1&nbsp;frame, 0.5 seconds, 1 second, 20 seconds, 1 minute, 5 minutes,&nbsp;and 10 minutes. </TD></TR><TR><TD>
PageUp/PageDown </TD><TD> move forward and backward to the nearest cut point </TD></TR><TR><TD>
&lt; or > </TD><TD> move forward or backward by 10 times the normal jump amount </TD></TR><TR><TD>
Space/Enter     </TD><TD> allows you to set or delete a cut point </TD></TR><TR><TD>
Z </TD><TD> loads the commercial skip list (if one exists) into the cutlist </TD></TR><TR><TD>
C or Q </TD><TD> clear all cut points in the cutlist </TD></TR><TR><TD>
I </TD><TD> Inverts the cutlist
</TD></TR></TABLE>
</CENTER><BR>
</P>
<H3>EPG</H3>

<P>
<BR><CENTER>
<TABLE BORDER><TR><TD>
Arrows </TD><TD> are used to move the highlighted program point around </TD></TR><TR><TD>
A, D, S, W </TD><TD> perform the same as left, right, down and up </TD></TR><TR><TD>
PageUp/PageDown </TD><TD> move the channel list up or down a page </TD></TR><TR><TD>
Home/End </TD><TD> move the highlight left or right by one day </TD></TR><TR><TD>
Ctrl+Left or &lt; </TD><TD> move the highlight left by one page </TD></TR><TR><TD>
Ctrl+Right or &gt; </TD><TD> move the highlight right by one page </TD></TR><TR><TD>
9, 3, 7, 1 </TD><TD> (like a numeric keypad) perform the same as PageUp, PageDown,&nbsp;Home and End </TD></TR><TR><TD>
I </TD><TD> bring up more information about a show, and allow you to&nbsp;schedule a recording. If you select "Record this showing"&nbsp;while watching Live TV you can "Instant Record" a program. </TD></TR><TR><TD>
Space/Enter </TD><TD> allow you resolve conflicts or change overrides. If the&nbsp;program is not already scheduled to record, it will instead act like&nbsp;pressing 'I'. </TD></TR><TR><TD>
M </TD><TD> when on a channel will change to that channel </TD></TR><TR><TD>
ESC or C </TD><TD> exits without changing the channel </TD></TR><TR><TD>
R </TD><TD> change the current item from Recording/Not-Recording.&nbsp;Successive keypresses cycle through the scheduled recording&nbsp;type list. </TD></TR><TR><TD>
X </TD><TD> change the channel to the currently selected channel without&nbsp;leaving the EPG (Most useful in the alternate EPG) </TD></TR><TR><TD>
? </TD><TD> mark/unmark the current channel as a "favorite" </TD></TR><TR><TD>
/ or 4 </TD><TD> toggle the guide listing between all channels and filtered&nbsp;"favorites"
</TD></TR></TABLE>
</CENTER><BR>
</P>
<H3>Setting Program or Channel Recording Priorities</H3>

<P>
<BR><CENTER>
<TABLE BORDER><TR><TD>
Right </TD><TD> increases priority value        </TD></TR><TR><TD>
Left </TD><TD> decreases priority value </TD></TR><TR><TD>
1 </TD><TD> sorts by title </TD></TR><TR><TD>
2 </TD><TD> sorts by priority </TD></TR><TR><TD>
Home/End        </TD><TD> toggle sort priority </TD></TR><TR><TD>
I </TD><TD> edit recording options      </TD></TR><TR><TD>
ESC </TD><TD> commits changes and exits
</TD></TR></TABLE>
</CENTER><BR>
</P>
<H3>Viewing Scheduled Recordings/Resolving Conflicts</H3>

<P>
<BR><CENTER>
<TABLE BORDER><TR><TD>
1 </TD><TD> show all recordings </TD></TR><TR><TD>
2 </TD><TD> show only important recordings </TD></TR><TR><TD>
Home/End        </TD><TD> toggle show showing all/important </TD></TR><TR><TD>
I </TD><TD> edit recording options </TD></TR><TR><TD>
Space/Enter     </TD><TD> resolve conflict or override
</TD></TR></TABLE>
</CENTER><BR>
</P>
<H3>Viewing Search Listings</H3>

<P>
<BR><CENTER>
<TABLE BORDER><TR><TD>
Home    </TD><TD> change to the previous view if applicable     </TD></TR><TR><TD>
End     </TD><TD> change to the next view if applicable </TD></TR><TR><TD>
M       </TD><TD> select another view if applicable. In the&nbsp;title and description search popup, press&nbsp;M again to edit or delete the selected view.
</TD></TR></TABLE>
</CENTER><BR>
</P>
<H3>Recording Profiles Setup Screen</H3>

<P>
<BR><CENTER>
<TABLE BORDER><TR><TD>
D       </TD><TD> on a custom profile group displays a popup to delete the group</TD></TR><TR><TD>
</TD></TR></TABLE>
</CENTER><BR>
</P>
<H3>Recording Groups</H3>

<P>In the Watch Recordings screen, Recording Groups allow you to separate
programs into user-defined categories, such as "Kids", "Alice", "Bob", etc. 
This can be used to reduce clutter, or to segregate content if you use the
PIN function.
<BR><CENTER>
<TABLE BORDER><TR><TD>
M       </TD><TD> change the view or to set a group password </TD></TR><TR><TD>
I       </TD><TD> move a program from one Recording Group to another
</TD></TR></TABLE>
</CENTER><BR>
</P>
<H3>Watch Recordings Screen</H3>

<P>
<BR><CENTER>
<TABLE BORDER><TR><TD>
1 or F1 </TD><TD> Meaning of the icons </TD></TR><TR><TD>
/ </TD><TD> Tags a recording. Tagged recordings can be played&nbsp;either in order or shuffled and deleted as a group.&nbsp;You can also change the recording group for several&nbsp;recordings at once by tagging them and using the &nbsp;Menu (m) button, selecting "Playlist options", &nbsp;then "Change Recording Group". </TD></TR><TR><TD>
? </TD><TD> Clear the tagged list.
</TD></TR></TABLE>
</CENTER><BR>
</P>
<H3>Remote Controls</H3>

<P>If you are using MythTV with just a remote control then it is suggested that you
map the remote control keys as described below.  Your remote control may not
have the same set of keys as those named below, the names are only a suggestion
that roughly correspond to the function.</P>
<P>If you are adding new key bindings to the program then consideration of this
suggested list will help users with remote controls.</P>
<P>This list assumes a minimal remote control that only has 20 keys, nearly all
features can be used with this configuration.  If you have more keys then you
can access all of the features.  With only 16 keys most features are usable.
<BR><CENTER>
<TABLE BORDER><TR><TD>
REMOTE CONTROL </TD><TD> LIRC KEYSTROKE </TD><TD> FUNCTION </TD></TR><TR><TD>
0 - 9 </TD><TD> 0 - 9 </TD><TD> channel selection, EPG navigation, ff/rew speed setting (with stickykeys)       </TD></TR><TR><TD>
Left Arrow </TD><TD> Left </TD><TD> scroll left, rewind </TD></TR><TR><TD>
Right Arrow </TD><TD> Right </TD><TD> scroll right, fast forward </TD></TR><TR><TD>
Up Arrow </TD><TD> Up </TD><TD> scroll up, channel change up </TD></TR><TR><TD>
Down Arrow </TD><TD> Down </TD><TD> scroll down, channel change down </TD></TR><TR><TD>
Select / OK / Play </TD><TD> Space </TD><TD> Select item, play (with stickykeys) set bookmark </TD></TR><TR><TD>
Cancel </TD><TD> Escape </TD><TD> Cancel, quit playback </TD></TR><TR><TD>
Menu </TD><TD> m </TD><TD> EPG (from watching TV) edit (from playback). </TD></TR><TR><TD>
Pause </TD><TD> p </TD><TD> Pause </TD></TR><TR><TD>
Other key 1 </TD><TD> i </TD><TD> Information </TD></TR><TR><TD>
Other key 2 </TD><TD> c </TD><TD> Change tuner card input
</TD></TR></TABLE>
</CENTER><BR>
</P>

<H2><A NAME="ss11.2">11.2</A> <A HREF="mythtv-HOWTO.html#toc11.2">Using themes with MythTV</A>
</H2>

<P>MythTV is "themeable", meaning that the visual appearance of the program
can be modified by the user without re-compiling or altering the program
functionality.  Download the MythThemes tarball from the website and untar it:</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
$ tar -xjf myththemes-0.21.tar.bz2
$ cd ~/myththemes-0.21
$ qmake myththemes.pro
$ su -
# make install
# exit
$
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>The theme will now be available in the mythfrontend Appearance section.</P>

<H2><A NAME="ss11.3">11.3</A> <A HREF="mythtv-HOWTO.html#toc11.3">Adding DishTV information to the database</A>
</H2>

<P>A script for adding Pay Per View information into the MythTV database for
DishTV subscribers is available at 
<A HREF="http://www.mythppv.com/">http://www.mythppv.com/</A>.</P>

<H2><A NAME="ss11.4">11.4</A> <A HREF="mythtv-HOWTO.html#toc11.4">Adding support for an external tuner</A>
</H2>

<P>MythTV supports changing the channel on an external tuner.  If you have
an external tuner, such as a DirecTV or digital cable set top box, you
should add <CODE>/usr/local/bin/changechannel</CODE> to your Input Connections in the
mythbackend configuration GUI.</P>
<P>However, there is not <B>changechannel</B> program per-se, because this is
going to be dependent on what sort of external tuner you have.  Look in the
<CODE>contrib/channel_changers</CODE> directory for a number of programs and
scripts which may be used to change channels.  Once you find one which
works, copy it to <CODE>/usr/local/bin/changechannel</CODE>.</P>
<P>Feel free to browse some of what sort of hardware is available at 
<A HREF="http://store.snapstream.com/accessories.html">http://store.snapstream.com/accessories.html</A>, or if you wish to
assemble your own, rather than purchase, the following may be helpful: 
<A HREF="http://www.dtvcontrol.com/">http://www.dtvcontrol.com/</A> for
cable pinouts.</P>

<H2><A NAME="ss11.5">11.5</A> <A HREF="mythtv-HOWTO.html#toc11.5">Using Shutdown/Wakeup</A>
</H2>

<P>What does the MythTV Shutdown/Wakeup function do? The scheduler on the
Master backend (MBE) keeps track of the idle status of the entire MythTV
system, including the Slave backends (SBE). If it considers the system to be
idle, and thus ready to shutdown, it sets the wakeuptime to the time of the
next recording and then proceeds to shut down all Slave backends and then
itself. Once it is time to begin recording, the Master backend and the Slave
Backends are automatically woken up.  This system allows MythTV to record
like a normal VCR, thereby conserving power when not in active use.</P>
<P>In order to use the Shutdown/Wakeup function there must be some method of
waking up the Master backend.  There are any number of solutions, but we
will discuss in detail two possibilities:</P>
<P>
<UL>
<LI>Use another server that runs 24/7 and have it send a WakeOnLAN (WOL)
packet to wake the Master backend.  This assumes that you have the WOL tools
installed, and that your Master backend motherboard supports WOL.</LI>
<LI>Use your motherboard's BIOS wakeup capability.  You'll need a motherboard
that supports BIOS wakeup, and some tools.  Two that work are: 
<A HREF="http://sourceforge.net/projects/nvram-wakeup">http://sourceforge.net/projects/nvram-wakeup</A> and 
<A HREF="http://www.malloc.de/tools/wakeup_clock.html">http://www.malloc.de/tools/wakeup_clock.html</A></LI>
</UL>
</P>

<H3>A deeper look into the operation</H3>

<P>The scheduler keeps track of the idle status of the MythTV system. To
determine whether or not the MythTV system is idle, the following conditions
must be met for a period of time defined in the "Idle timeout (secs)"
parameter.
<UL>
<LI>no client is connected to the server</LI>
<LI>no recording (neither LiveTV nor a regular recording) is currently taking place</LI>
<LI>no recording starts within a definable amount of time ("Max. wait for recording (min)")</LI>
<LI>the "pre Shutdown check-command" returns 0 </LI>
</UL>
</P>
<P>If we get to this idle state the Master backend will set the wakeuptime using the "Set
wakeuptime command", which is the same for WOL and BIOS wakeup. The Master backend will
then shut down the Slave backends and itself using the "Server halt command".</P>
<P>One caveat is that the scheduler tries to guess if the Master backend was started by a
wakeup call or by the user. If it thinks it was woken up by a user, it
blocks shutdown until a client connects to the Master backend, after which it will
behave as described above. To disable this feature, unset "Block shutdown
before client connected" in the mythfrontend Setup->Setup->General screen.</P>
<P>Once it is time to startup the system, the Master backend is woken up first and will
wakeup the Slave backends using the "Wake command for slaves". At this time, there is
no support for starting only the required Slave backend, so all Slave backends will startup.</P>

<H3>Setting up the MythTV side of this extension.</H3>

<P>There are a number of options that are used to control the Shutdown /
Wakeup feature.</P>
<P>Shutdown/Wakeup Options:
<UL>
<LI>"Idle timeout (secs)" is the time the server waits while idle until a
shutdown occurs.</LI>
<LI>"Max. wait for recording (min)" is the time the Master backend waits for a recording
without shutting down. For example, this would be used to prevent a 10
minute system shutdown if a recording is set to start 15 minutes from now.</LI>
<LI>"Startup before rec. (secs)" Sets how long before a programmed
recording the MythTV system will be woken up.  This should be roughly be the
time your systems need to bootup, and if you have Slave backends, you'll
need to ensure this value is long enough for all your machines to perform
their bootup cycle.</LI>
<LI>"Wakeup time format" is the format of the wakeup time that is given in
the "Set wakeuptime command" as a parameter "$time". You need to set this
according to your wakeup mechanism. If you need seconds since the epoch
(1970-01-01) set the "Wakeup time format" to "time_t".</LI>
<LI>"Set wakeuptime command" is the command executed to set the new wakeuptime. </LI>
<LI>"Server Halt Command" is the command executed to shutdown the Master
backend and the Slave backends.</LI>
<LI>"pre Shutdown check-command" is used to give a
"Go/NO-GO" decision from a non-MythTV source.  This command is executed
immediately before the shutdown would occur. The return value is use to make
the following choices:
<UL>
<LI>If it returns a "0" the shutdown will occur as scheduled.</LI>
<LI>If it returns a "1" the "idle timeout" will be reset and the system
waits again for the timeout.</LI>
<LI>If it returns a "2" the entire shutdown sequence is reset.  This means
that a new client connect is needed before a shutdown occurs, unless you have
the "Wait for client connect" setting disabled, in which case this is the same as
returning "1".  An example of a use for this return value is to prevent the shutdown
if a user is currently logged in, or if a specific program (i.e. transcode,
automatic updates, etc.) is currently running. If you don't need it, leave
the field blank.</LI>
</UL>
</LI>
</UL>
</P>
<P>The "WakeOnLan settings":
These settings have nothing to do with using BIOS or WOL wakeup, they are
the same for both.
<UL>
<LI>"Master backend" This setting defines timings for the frontends to
wakeup the Master backend using WOL. Useful if your frontend can emit a WOL
packet so you don't need to physically go to the Master backend if you're
trying to watch TV.</LI>
<LI>"Reconnect wait time (secs)" is the time the frontend waits after
executing the "Wake command" before attempting to retry the connection. This
should be roughly the amount of time your Master backend needs for bootup.
Set to "0" to disable. The frontends will retry to connect for "Count of
reconnect tries" times before giving up.</LI>
<LI>"Wake command for slaves" is the <EM>one</EM> command executed to wake
your Slave backends. This should be a script that contains the calls to
wakeup all Slave backend systems.</LI>
</UL>
</P>

<H3>Using WOL to wake your Master backend. </H3>

<P>To use WOL to wake your Master backend you will need a WOL capable Master
backend, a machine that runs 24/7 which can execute an at-job and nc (netcat)
on the Master backend. I use some little bash scripts to make my DSL router
wakeup my mythbox if required.</P>
<P>Replace $SERVER and $PORT with your own settings!
On my Master backend I have a script that gets called as 'setwakeuptime command' which
looks like the following:
<BLOCKQUOTE><CODE>
<PRE>
#! /bin/sh
echo $@ | nc $SERVER $PORT
</PRE>
</CODE></BLOCKQUOTE>

This simply cats the parameters (that is $time) to my 24/7 server. On my
$SERVER I have (x)inetd listening on $PORT starting a little script which
cares about setting the at-job. The following additions are necessary on the
$SERVER:</P>
<P>If you use <B>inetd</B>:</P>
<P>In <CODE>/etc/inetd.conf</CODE> add:
<BLOCKQUOTE><CODE>
<PRE>
mythwake stream tcp nowait mythtv /usr/sbin/tcpd /usr/local/bin/mythwake
</PRE>
</CODE></BLOCKQUOTE>

If you use <B>xinetd</B>, save the following as <B>mythwake</B> in your
<CODE>/etc/xinet.d/</CODE> directory:
<BLOCKQUOTE><CODE>
<PRE>
service mythwake
  {    
        socket_type     = stream
        wait            = no
        user            = mythtv        
        protocol        = tcp
        id              = mythwake
        server          = /usr/local/bin/mythwake
  }
</PRE>
</CODE></BLOCKQUOTE>

and add the following to <CODE>/etc/services</CODE>:
<BLOCKQUOTE><CODE>
<PRE>
mythwake        $PORT/tcp
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Finally, <CODE>/usr/local/bin/mythwake</CODE> looks like:
<BLOCKQUOTE><CODE>
<PRE>
#! /bin/bash
#this should be a command to wake your server
WAKECMD="#!/bin/sh\n /usr/local/bin/wakeMBE"
#first we need to delete all wake jobs in queue
for JOB in atq | cut -f 1 ; do
    atrm $JOB;
done
#now we read the date from 'nc'
read date;
#now set the atjob
echo -e "$WAKECMD" | at $date ;
</PRE>
</CODE></BLOCKQUOTE>

<B>SECURITY WARNING</B>:
Be sure to secure $SERVER:$PORT from untrusted networks, because this
allows 3rd parties to run arbitrary code on your server!</P>

<H3>Using BIOS wakeup to wake your Master backend.</H3>

<P>Since I don't use this, I cannot say much about this. If your motherboard
supports any wakeup tool you have to call that tool as "Set wakeuptime
command" with the "Wakeup time format" suitable for that tool.</P>
<H3>Wakeup the MySQL server using WOL</H3>

<P>If your MySQL server and your Master backend are not on the same machine,
you can have the Master backend wake your MySQL server using WOL. You will
find the settings for this in the second page of the mythtv-setup program,
or at the end of <CODE>mysql.txt</CODE>.  The meanings are the same as
discussed in "The WakeOnLan settings" above.</P>

<H3>Tips/Tricks:</H3>

<P>If, for example, one of the Slave backends is also your desktop computer,
you could simply use a little script as 'server halt command' which first
calls <CODE>/sbin/shutdown -t TIMEOUT</CODE> where TIMEOUT is a value sufficient
for you to react.  You could then popup a window using *dialog, asking for
permission to shutdown. If you cancel the shutdown, simply call
<CODE>/sbin/shutdown -c</CODE>.</P>
<P>If you get "nvram-wakeup: /dev/rtc: Device or resource busy" your
set-wakeuptime-script should stop the program that uses <CODE>/dev/rtc</CODE> before
setting the wakeuptime.</P>
<H2><A NAME="ss11.6">11.6</A> <A HREF="mythtv-HOWTO.html#toc11.6">Controlling the mythfrontend via telnet</A>
</H2>

<P>To use this feature you must first enable it in Settings>General>General</P>
<P>The network control listens on port 6546, as demonstrated below:</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
$ telnet basement 6546
Connected to basement.
Escape character is '^]'.
MythFrontend Network Control
Type 'help' for usage information
---------------------------------
# help
Valid Commands:
---------------
jump               - Jump to a specified location in Myth
key                - Send a keypress to the program
play               - Playback related commands
query              - Queries
exit               - Exit Network Control

Type 'help COMMANDNAME' for help on any specific command.

# help jump
Usage: jump JUMPPOINT

Where JUMPPOINT is one of the following:
channelpriorities    - Channel Recording Priorities
channelrecpriority   - Channel Recording Priorities
deletebox            - TV Recording Deletion
deleterecordings     - TV Recording Deletion
guidegrid            - Program Guide
livetv               - Live TV
livetvinguide        - Live TV In Guide
mainmenu             - Main Menu
...snip...
# exit
$
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Please note that this feature only allows one connection at a time, so any
new connections will automatically terminate prior ones.</P>

<HR>
<A HREF="mythtv-HOWTO-12.html">Next</A>
<A HREF="mythtv-HOWTO-10.html">Previous</A>
<A HREF="mythtv-HOWTO.html#toc11">Contents</A>
</BODY>
</HTML>
